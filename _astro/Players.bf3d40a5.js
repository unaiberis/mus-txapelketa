import{n as oe,s as it,r as Se,a as Be,i as ct,S as Ne,b as Me,e as y,t as Z,c as $,d as E,f as P,g as F,h,j as H,k as m,l as Y,m as i,o as Q,p as Ke,q as dt,u as We,v as De,w as ut,x as we,y as ue,z as ie,A as Le,B as ft,C as de,D as ge,E as Ve,F as mt,G as ht,H as Qe,I as Ye,J as Xe,K as et,L as Te,M as pt,_ as ze,N as xe,O as Je}from"./bracketryUtils.92cab0b8.js";/* empty css                       */function Ie(a){return a?.length!==void 0?a:Array.from(a)}const gt="Parejas",bt="{count} partidos",vt="No hay parejas todavía.",_t="{n}. mesa",kt="Añadir Pareja",wt="Jugador A",yt="Jugador B",Et="Guardar",At="Cancelar",It="Editar",St="Borrar",Bt="Completar hasta:",Pt="Ejecutar",zt="Importar Jugadores",xt="Limpiar Todo",Ct="Crear Cuadro Aleatorio",Nt="Borrar Cuadro",Mt="Al mostrar el cuadro se bloqueará la edición de parejas. ¿Deseas continuar?",Ot="¿Estás seguro de borrar el cuadro? Esto permitirá volver a editar las parejas.",Dt='No hay cuadro creado y no hay parejas. Pulsa "Crear Cuadro Aleatorio" o añade parejas primero.',Lt="Excel",Vt="CSV",Tt="{n}. ronda",Jt="¿Estás seguro? Esto eliminará todos los jugadores y parejas.",Ut="Necesitas al menos {n} parejas para crear un cuadro aleatorio",Gt={pairsTitle:gt,matchesCount:bt,noPairs:vt,table_short:_t,addPair:kt,playerA:wt,playerB:yt,save:Et,cancel:At,edit:It,remove:St,completeTo:Bt,execute:Pt,importPlayers:zt,clearAll:xt,createBracket:Ct,deleteBracket:Nt,createConfirm:Mt,deleteConfirm:Ot,noBracketAndPairs:Dt,excel:Lt,csv:Vt,round_label:Tt,confirmClear:Jt,needAtLeastPairs:Ut},jt="Pairs",$t="{count} matches",Ht="No pairs yet.",Rt="Table {n}",qt="Add Pair",Zt="Player A",Ft="Player B",Kt="Save",Wt="Cancel",Qt="Edit",Yt="Remove",Xt="Complete to:",ea="Execute",ta="Import Players",aa="Clear All",ra="Create Random Bracket",na="Delete Bracket",la="Showing the bracket will lock editing of pairs. Continue?",oa="Are you sure you want to delete the bracket? This will allow editing pairs again.",sa='No bracket created and no pairs. Click "Create Random Bracket" or add pairs first.',ia="Excel",ca="CSV",da="Round {n}",ua="Are you sure? This will delete all players and pairs.",fa="You need at least {n} pairs to create a bracket",ma={pairsTitle:jt,matchesCount:$t,noPairs:Ht,table_short:Rt,addPair:qt,playerA:Zt,playerB:Ft,save:Kt,cancel:Wt,edit:Qt,remove:Yt,completeTo:Xt,execute:ea,importPlayers:ta,clearAll:aa,createBracket:ra,deleteBracket:na,createConfirm:la,deleteConfirm:oa,noBracketAndPairs:sa,excel:ia,csv:ca,round_label:da,confirmClear:ua,needAtLeastPairs:fa},ha="Bikoteak",pa="{count} partiduk",ga="Oraindik ez dago bikoterik.",ba="{n}. mahaia",va="Bikotea gehitu",_a="Jokalari A",ka="Jokalari B",wa="Gorde",ya="Utzi",Ea="Editatu",Aa="Ezabatu",Ia="Osatu arte:",Sa="Exekutatu",Ba="Jokalariak inportatu",Pa="Denak garbitu",za="Sortu Koadro Aleatorioa",xa="Ezabatu Koadroa",Ca="Koadroa erakustean bikoteen edizioa blokeatuko da. Jarraitu nahi duzu?",Na="Ziur zaude koadroa ezabatu nahi duzula? Honek berriro bikoteak editatzeko aukera emango du.",Ma='Ez dago koadrorik eta ez daude bikoterik. Sakatu "Sortu Koadro Aleatorioa" edo gehitu bikoteak lehenik.',Oa="Excel",Da="CSV",La="{n}. txanda",Va="Ziur zaude? Honek jokalari eta bikote guztiak ezabatuko ditu.",Ta="Gutxienez {n} bikote behar dituzu koadro aleatorio bat sortzeko",Ja={pairsTitle:ha,matchesCount:pa,noPairs:ga,table_short:ba,addPair:va,playerA:_a,playerB:ka,save:wa,cancel:ya,edit:Ea,remove:Aa,completeTo:Ia,execute:Sa,importPlayers:Ba,clearAll:Pa,createBracket:za,deleteBracket:xa,createConfirm:Ca,deleteConfirm:Na,noBracketAndPairs:Ma,excel:Oa,csv:Da,round_label:La,confirmClear:Va,needAtLeastPairs:Ta},pe=[];function Ua(a,e){return{subscribe:tt(a,e).subscribe}}function tt(a,e=oe){let t;const r=new Set;function n(s){if(Be(a,s)&&(a=s,t)){const p=!pe.length;for(const k of r)k[1](),pe.push(k,a);if(p){for(let k=0;k<pe.length;k+=2)pe[k][0](pe[k+1]);pe.length=0}}}function o(s){n(s(a))}function l(s,p=oe){const k=[s,p];return r.add(k),r.size===1&&(t=e(n,o)||oe),s(a),()=>{r.delete(k),r.size===0&&t&&(t(),t=null)}}return{set:n,update:o,subscribe:l}}function Ga(a,e,t){const r=!Array.isArray(a),n=r?[a]:a;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return Ua(t,(l,s)=>{let p=!1;const k=[];let A=0,z=oe;const D=()=>{if(A)return;z();const g=e(r?k[0]:k,l,s);o?l(g):z=ct(g)?g:oe},_=n.map((g,b)=>it(g,N=>{k[b]=N,A&=~(1<<b),p&&D()},()=>{A|=1<<b}));return p=!0,D(),function(){Se(_),z(),p=!1}})}const ye={es:Gt,en:ma,eu:Ja},ja=typeof window<"u"?localStorage.getItem("lang"):null,at=tt(ja||"es");at.subscribe(a=>{typeof window<"u"&&localStorage.setItem("lang",a)});const Ae=Ga(at,a=>(e,t)=>{const r=ye[a]&&ye[a][e]||ye.en&&ye.en[e]||e;if(!t)return r;let n=String(r);return Object.keys(t).forEach(o=>{n=n.replace(new RegExp(`{${o}}`,"g"),String(t[o]))}),n});function Ue(a,e,t){const r=a.slice();return r[20]=e[t][0],r[21]=e[t][1],r[19]=t,r}function Ge(a,e,t){const r=a.slice();return r[17]=e[t],r[19]=t,r}function $a(a){let e,t=Ie(a[0]),r=[];for(let n=0;n<t.length;n+=1)r[n]=$e(Ue(a,t,n));return{c(){e=y("div");for(let n=0;n<r.length;n+=1)r[n].c();this.h()},l(n){e=E(n,"DIV",{class:!0});var o=P(e);for(let l=0;l<r.length;l+=1)r[l].l(o);o.forEach(h),this.h()},h(){m(e,"class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1")},m(n,o){Y(n,e,o);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(n,o){if(o&2043){t=Ie(n[0]);let l;for(l=0;l<t.length;l+=1){const s=Ue(n,t,l);r[l]?r[l].p(s,o):(r[l]=$e(s),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=t.length}},d(n){n&&h(e),We(r,n)}}}function Ha(a){let e,t=a[6]("noPairs")+"",r;return{c(){e=y("div"),r=Z(t),this.h()},l(n){e=E(n,"DIV",{class:!0});var o=P(e);r=F(o,t),o.forEach(h),this.h()},h(){m(e,"class","text-sm text-slate-500")},m(n,o){Y(n,e,o),i(e,r)},p(n,o){o&64&&t!==(t=n[6]("noPairs")+"")&&Q(r,t)},d(n){n&&h(e)}}}function Ra(a){let e,t=Ie(a[2]),r=[];for(let n=0;n<t.length;n+=1)r[n]=qe(Ge(a,t,n));return{c(){e=y("div");for(let n=0;n<r.length;n+=1)r[n].c();this.h()},l(n){e=E(n,"DIV",{class:!0});var o=P(e);for(let l=0;l<r.length;l+=1)r[l].l(o);o.forEach(h),this.h()},h(){m(e,"class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2")},m(n,o){Y(n,e,o);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(n,o){if(o&68){t=Ie(n[2]);let l;for(l=0;l<t.length;l+=1){const s=Ge(n,t,l);r[l]?r[l].p(s,o):(r[l]=qe(s),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=t.length}},d(n){n&&h(e),We(r,n)}}}function qa(a){let e,t,r,n=a[19]+1+"",o,l,s,p,k=a[20].name+"",A,z,D,_="—",g,b=a[21].name+"",N,J,M,B=!a[1]&&je(a);return{c(){e=y("div"),t=y("div"),r=Z("#"),o=Z(n),l=$(),s=y("div"),p=y("div"),A=Z(k),z=$(),D=y("span"),D.textContent=_,g=$(),N=Z(b),J=$(),B&&B.c(),M=De(),this.h()},l(u){e=E(u,"DIV",{class:!0});var V=P(e);t=E(V,"DIV",{class:!0});var x=P(t);r=F(x,"#"),o=F(x,n),x.forEach(h),l=H(V),s=E(V,"DIV",{class:!0});var L=P(s);p=E(L,"DIV",{class:!0});var w=P(p);A=F(w,k),z=H(w),D=E(w,"SPAN",{class:!0,"data-svelte-h":!0}),ut(D)!=="svelte-1c9q204"&&(D.textContent=_),g=H(w),N=F(w,b),w.forEach(h),L.forEach(h),V.forEach(h),J=H(u),B&&B.l(u),M=De(),this.h()},h(){m(t,"class","text-xxs text-slate-400 w-6 svelte-6agwrc"),m(D,"class","text-slate-400 text-xxs svelte-6agwrc"),m(p,"class","font-medium text-slate-800 leading-tight truncate"),we(p,"text-base",a[1]),we(p,"text-sm",!a[1]),m(s,"class","truncate"),m(e,"class","flex items-center gap-3 truncate")},m(u,V){Y(u,e,V),i(e,t),i(t,r),i(t,o),i(e,l),i(e,s),i(s,p),i(p,A),i(p,z),i(p,D),i(p,g),i(p,N),Y(u,J,V),B&&B.m(u,V),Y(u,M,V)},p(u,V){V&1&&k!==(k=u[20].name+"")&&Q(A,k),V&1&&b!==(b=u[21].name+"")&&Q(N,b),V&2&&we(p,"text-base",u[1]),V&2&&we(p,"text-sm",!u[1]),u[1]?B&&(B.d(1),B=null):B?B.p(u,V):(B=je(u),B.c(),B.m(M.parentNode,M))},d(u){u&&(h(e),h(J),h(M)),B&&B.d(u)}}}function Za(a){let e,t,r,n=a[19]+1+"",o,l,s,p,k,A,z,D,_,g,b=a[6]("save")+"",N,J,M,B=a[6]("cancel")+"",u,V,x;function L(){return a[13](a[19])}return{c(){e=y("div"),t=y("div"),r=Z("#"),o=Z(n),l=$(),s=y("input"),k=$(),A=y("input"),D=$(),_=y("div"),g=y("button"),N=Z(b),J=$(),M=y("button"),u=Z(B),this.h()},l(w){e=E(w,"DIV",{class:!0});var S=P(e);t=E(S,"DIV",{class:!0});var W=P(t);r=F(W,"#"),o=F(W,n),W.forEach(h),l=H(S),s=E(S,"INPUT",{class:!0,"aria-label":!0}),k=H(S),A=E(S,"INPUT",{class:!0,"aria-label":!0}),S.forEach(h),D=H(w),_=E(w,"DIV",{class:!0});var ae=P(_);g=E(ae,"BUTTON",{class:!0});var re=P(g);N=F(re,b),re.forEach(h),J=H(ae),M=E(ae,"BUTTON",{class:!0});var ne=P(M);u=F(ne,B),ne.forEach(h),ae.forEach(h),this.h()},h(){m(t,"class","text-xxs text-slate-400 w-6 svelte-6agwrc"),m(s,"class","flex-1 border rounded px-2 py-1 text-xs"),m(s,"aria-label",p=a[6]("playerA")),m(A,"class","w-36 border rounded px-2 py-1 text-xs"),m(A,"aria-label",z=a[6]("playerB")),m(e,"class","flex items-center gap-2 w-full"),m(g,"class","text-xxs px-2 py-0.5 bg-sky-600 text-white rounded svelte-6agwrc"),m(M,"class","text-xxs px-2 py-0.5 bg-white border rounded svelte-6agwrc"),m(_,"class","flex gap-1 ml-2")},m(w,S){Y(w,e,S),i(e,t),i(t,r),i(t,o),i(e,l),i(e,s),ue(s,a[4]),i(e,k),i(e,A),ue(A,a[5]),Y(w,D,S),Y(w,_,S),i(_,g),i(g,N),i(_,J),i(_,M),i(M,u),V||(x=[ie(s,"input",a[11]),ie(A,"input",a[12]),ie(g,"click",L),ie(M,"click",a[9])],V=!0)},p(w,S){a=w,S&64&&p!==(p=a[6]("playerA"))&&m(s,"aria-label",p),S&16&&s.value!==a[4]&&ue(s,a[4]),S&64&&z!==(z=a[6]("playerB"))&&m(A,"aria-label",z),S&32&&A.value!==a[5]&&ue(A,a[5]),S&64&&b!==(b=a[6]("save")+"")&&Q(N,b),S&64&&B!==(B=a[6]("cancel")+"")&&Q(u,B)},d(w){w&&(h(e),h(D),h(_)),V=!1,Se(x)}}}function je(a){let e,t,r=a[6]("edit")+"",n,o,l,s=a[6]("remove")+"",p,k,A;function z(){return a[14](a[19])}function D(){return a[15](a[19])}return{c(){e=y("div"),t=y("button"),n=Z(r),o=$(),l=y("button"),p=Z(s),this.h()},l(_){e=E(_,"DIV",{class:!0});var g=P(e);t=E(g,"BUTTON",{class:!0});var b=P(t);n=F(b,r),b.forEach(h),o=H(g),l=E(g,"BUTTON",{class:!0});var N=P(l);p=F(N,s),N.forEach(h),g.forEach(h),this.h()},h(){m(t,"class","text-xxs text-slate-500 hover:text-sky-600 svelte-6agwrc"),m(l,"class","text-xxs text-red-600 hover:underline svelte-6agwrc"),m(e,"class","flex items-center gap-2")},m(_,g){Y(_,e,g),i(e,t),i(t,n),i(e,o),i(e,l),i(l,p),k||(A=[ie(t,"click",z),ie(l,"click",D)],k=!0)},p(_,g){a=_,g&64&&r!==(r=a[6]("edit")+"")&&Q(n,r),g&64&&s!==(s=a[6]("remove")+"")&&Q(p,s)},d(_){_&&h(e),k=!1,Se(A)}}}function $e(a){let e,t;function r(l,s){return l[3]===l[19]?Za:qa}let n=r(a),o=n(a);return{c(){e=y("div"),o.c(),t=$(),this.h()},l(l){e=E(l,"DIV",{class:!0});var s=P(e);o.l(s),t=H(s),s.forEach(h),this.h()},h(){m(e,"class","bg-white border rounded-md px-2 py-1 shadow-sm flex items-center justify-between gap-3 hover:shadow-md transition")},m(l,s){Y(l,e,s),o.m(e,null),i(e,t)},p(l,s){n===(n=r(l))&&o?o.p(l,s):(o.d(1),o=n(l),o&&(o.c(),o.m(e,t)))},d(l){l&&h(e),o.d()}}}function He(a){let e,t=fe(a[17].a)+"",r;return{c(){e=y("div"),r=Z(t),this.h()},l(n){e=E(n,"DIV",{class:!0});var o=P(e);r=F(o,t),o.forEach(h),this.h()},h(){m(e,"class","text-xxs text-wood-700/80 w-10 flex-shrink-0 svelte-6agwrc")},m(n,o){Y(n,e,o),i(e,r)},p(n,o){o&4&&t!==(t=fe(n[17].a)+"")&&Q(r,t)},d(n){n&&h(e)}}}function Re(a){let e,t=fe(a[17].b)+"",r;return{c(){e=y("div"),r=Z(t),this.h()},l(n){e=E(n,"DIV",{class:!0});var o=P(e);r=F(o,t),o.forEach(h),this.h()},h(){m(e,"class","text-xxs text-wood-700/80 w-10 flex-shrink-0 svelte-6agwrc")},m(n,o){Y(n,e,o),i(e,r)},p(n,o){o&4&&t!==(t=fe(n[17].b)+"")&&Q(r,t)},d(n){n&&h(e)}}}function qe(a){let e,t,r,n=a[6]("table_short",{n:a[19]+1})+"",o,l,s,p,k=fe(a[17].a),A,z,D=Ee(a[17].a)+"",_,g,b,N=fe(a[17].b),J,M,B=Ee(a[17].b)+"",u,V,x=k&&He(a),L=N&&Re(a);return{c(){e=y("div"),t=y("div"),r=y("div"),o=Z(n),l=$(),s=y("div"),p=y("div"),x&&x.c(),A=$(),z=y("div"),_=Z(D),g=$(),b=y("div"),L&&L.c(),J=$(),M=y("div"),u=Z(B),V=$(),this.h()},l(w){e=E(w,"DIV",{class:!0});var S=P(e);t=E(S,"DIV",{class:!0});var W=P(t);r=E(W,"DIV",{class:!0});var ae=P(r);o=F(ae,n),ae.forEach(h),W.forEach(h),l=H(S),s=E(S,"DIV",{class:!0});var re=P(s);p=E(re,"DIV",{class:!0});var ne=P(p);x&&x.l(ne),A=H(ne),z=E(ne,"DIV",{class:!0});var se=P(z);_=F(se,D),se.forEach(h),ne.forEach(h),g=H(re),b=E(re,"DIV",{class:!0});var ee=P(b);L&&L.l(ee),J=H(ee),M=E(ee,"DIV",{class:!0});var le=P(M);u=F(le,B),le.forEach(h),ee.forEach(h),re.forEach(h),V=H(S),S.forEach(h),this.h()},h(){m(r,"class","text-xxs text-wood-700/80 svelte-6agwrc"),m(t,"class","flex items-center justify-between mb-2"),m(z,"class","truncate"),m(p,"class","bg-panel-50 text-panel-700 rounded-md px-2 py-1 text-sm font-medium truncate flex items-center gap-2 border border-wood-100"),m(M,"class","truncate"),m(b,"class","bg-panel-50 text-panel-700 rounded-md px-2 py-1 text-sm font-medium truncate flex items-center gap-2 border border-wood-100"),m(s,"class","flex flex-col gap-1"),m(e,"class","bg-panel-100 px-3 py-2 transition rounded-md border border-wood-100")},m(w,S){Y(w,e,S),i(e,t),i(t,r),i(r,o),i(e,l),i(e,s),i(s,p),x&&x.m(p,null),i(p,A),i(p,z),i(z,_),i(s,g),i(s,b),L&&L.m(b,null),i(b,J),i(b,M),i(M,u),i(e,V)},p(w,S){S&64&&n!==(n=w[6]("table_short",{n:w[19]+1})+"")&&Q(o,n),S&4&&(k=fe(w[17].a)),k?x?x.p(w,S):(x=He(w),x.c(),x.m(p,A)):x&&(x.d(1),x=null),S&4&&D!==(D=Ee(w[17].a)+"")&&Q(_,D),S&4&&(N=fe(w[17].b)),N?L?L.p(w,S):(L=Re(w),L.c(),L.m(b,J)):L&&(L.d(1),L=null),S&4&&B!==(B=Ee(w[17].b)+"")&&Q(u,B)},d(w){w&&h(e),x&&x.d(),L&&L.d()}}}function Fa(a){let e,t,r,n=a[6]("pairsTitle")+"",o,l,s,p=a[6]("matchesCount",{count:a[2]&&a[2].length>0?a[2].length:a[0].length})+"",k,A,z;function D(b,N){return b[2]&&b[2].length>0?Ra:b[0].length===0?Ha:$a}let _=D(a),g=_(a);return{c(){e=y("div"),t=y("div"),r=y("h2"),o=Z(n),l=$(),s=y("div"),k=Z(p),A=$(),z=y("div"),g.c(),this.h()},l(b){e=E(b,"DIV",{class:!0});var N=P(e);t=E(N,"DIV",{class:!0});var J=P(t);r=E(J,"H2",{class:!0});var M=P(r);o=F(M,n),M.forEach(h),l=H(J),s=E(J,"DIV",{class:!0});var B=P(s);k=F(B,p),B.forEach(h),J.forEach(h),A=H(N),z=E(N,"DIV",{class:!0});var u=P(z);g.l(u),u.forEach(h),N.forEach(h),this.h()},h(){m(r,"class","text-sm font-bold"),m(s,"class","text-sm text-wood-700/80"),m(t,"class","flex items-center justify-between"),m(z,"class","mt-2"),m(e,"class","bg-panel-50 text-panel-700 p-3 rounded-lg border border-wood-200 shadow-card-md")},m(b,N){Y(b,e,N),i(e,t),i(t,r),i(r,o),i(t,l),i(t,s),i(s,k),i(e,A),i(e,z),g.m(z,null)},p(b,[N]){N&64&&n!==(n=b[6]("pairsTitle")+"")&&Q(o,n),N&69&&p!==(p=b[6]("matchesCount",{count:b[2]&&b[2].length>0?b[2].length:b[0].length})+"")&&Q(k,p),_===(_=D(b))&&g?g.p(b,N):(g.d(1),g=_(b),g&&(g.c(),g.m(z,null)))},i:oe,o:oe,d(b){b&&h(e),g.d()}}}function fe(a){const e=(a||"").toString().match(/#(\d+)$/);return e?`#${e[1]}`:""}function Ee(a){return(a||"").toString().replace(/\s*#\d+$/,"")}function Ka(a,e,t){let r;Ke(a,Ae,u=>t(6,r=u));let{pairs:n=[]}=e,{viewOnly:o=!1}=e,{matchLabels:l=[]}=e;const s=dt();function p(u){s("removePair",u)}let k=null,A="",z="";function D(u){t(3,k=u),t(4,A=n[u][0].name),t(5,z=n[u][1].name)}function _(){t(3,k=null),t(4,A=""),t(5,z="")}function g(u){s("updatePair",{index:u,a:A.trim(),b:z.trim()}),_()}function b(){A=this.value,t(4,A)}function N(){z=this.value,t(5,z)}const J=u=>g(u),M=u=>D(u),B=u=>p(u);return a.$$set=u=>{"pairs"in u&&t(0,n=u.pairs),"viewOnly"in u&&t(1,o=u.viewOnly),"matchLabels"in u&&t(2,l=u.matchLabels)},a.$$.update=()=>{a.$$.dirty&2&&o&&_()},[n,o,l,k,A,z,r,p,D,_,g,b,N,J,M,B]}class Wa extends Ne{constructor(e){super(),Me(this,e,Ka,Fa,Be,{pairs:0,viewOnly:1,matchLabels:2})}}function Qa(a){let e,t;return{c(){e=y("div"),t=y("div"),this.h()},l(r){e=E(r,"DIV",{class:!0});var n=P(e);t=E(n,"DIV",{id:!0,class:!0,style:!0}),P(t).forEach(h),n.forEach(h),this.h()},h(){m(t,"id","brackets-viewer-wrapper"),m(t,"class","brackets-viewer mt-0 w-full min-h-[48px] bracket-frame"),Le(t,"height","100%"),Le(t,"overflow","hidden"),m(e,"class","brackets-side border-l-4 border-wood-700 bg-gradient-to-b from-tapete-900/5 to-transparent svelte-ybka1i")},m(r,n){Y(r,e,n),i(e,t),a[1](t)},p:oe,i:oe,o:oe,d(r){r&&h(e),a[1](null)}}}function Ya(a,e,t){let r=null;function n(o){ft[o?"unshift":"push"](()=>{r=o,t(0,r)})}return[r,n]}class Xa extends Ne{constructor(e){super(),Me(this,e,Ya,Qa,Be,{})}}function er(a){const e=[...a];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}const rt="mus:players";function ve(a){try{localStorage.setItem(rt,JSON.stringify(a))}catch(e){console.warn("Could not save players to localStorage",e)}}function tr(){try{const a=localStorage.getItem(rt);return a?JSON.parse(a):null}catch(a){return console.warn("Could not load players from localStorage",a),null}}const nt="mus:pairs";function Ce(a){try{localStorage.setItem(nt,JSON.stringify(a))}catch(e){console.warn("Could not save pairs to localStorage",e)}}function ar(){try{const a=localStorage.getItem(nt);return a?JSON.parse(a):null}catch(a){return console.warn("Could not load pairs from localStorage",a),null}}function Ze(a){let e,t;return e=new Wa({props:{pairs:a[3],matchLabels:a[5],viewOnly:a[6]}}),e.$on("removePair",a[15]),e.$on("updatePair",a[16]),{c(){Qe(e.$$.fragment)},l(r){Ye(e.$$.fragment,r)},m(r,n){Xe(e,r,n),t=!0},p(r,n){const o={};n[0]&8&&(o.pairs=r[3]),n[0]&32&&(o.matchLabels=r[5]),n[0]&64&&(o.viewOnly=r[6]),e.$set(o)},i(r){t||(de(e.$$.fragment,r),t=!0)},o(r){ge(e.$$.fragment,r),t=!1},d(r){et(e,r)}}}function Fe(a){let e,t,r;return t=new Xa({}),{c(){e=y("div"),Qe(t.$$.fragment),this.h()},l(n){e=E(n,"DIV",{class:!0});var o=P(e);Ye(t.$$.fragment,o),o.forEach(h),this.h()},h(){m(e,"class","w-full lg:w-2/5 min-h-[120px] bg-gray-50 overflow-hidden sticky p-0 m-0")},m(n,o){Y(n,e,o),Xe(t,e,null),r=!0},i(n){r||(de(t.$$.fragment,n),r=!0)},o(n){ge(t.$$.fragment,n),r=!1},d(n){n&&h(e),et(t)}}}function rr(a){let e,t,r,n=a[8]("addPair")+"",o,l,s,p,k,A=a[8]("playerA")+"",z,D,_,g,b,N,J,M,B=a[8]("playerB")+"",u,V,x,L,w,S,W,ae=a[8]("addPair")+"",re,ne,se,ee,le,me,X,he,_e,q=a[4]&&Ze(a),K=a[0]&&a[6]&&Fe();return{c(){e=y("div"),t=y("div"),r=y("h3"),o=Z(n),l=$(),s=y("div"),p=y("div"),k=y("label"),z=Z(A),D=$(),_=y("input"),N=$(),J=y("div"),M=y("label"),u=Z(B),V=$(),x=y("input"),S=$(),W=y("button"),re=Z(ae),se=$(),ee=y("div"),le=y("div"),q&&q.c(),me=$(),K&&K.c(),this.h()},l(T){e=E(T,"DIV",{class:!0});var c=P(e);t=E(c,"DIV",{class:!0});var v=P(t);r=E(v,"H3",{class:!0});var f=P(r);o=F(f,n),f.forEach(h),l=H(v),s=E(v,"DIV",{class:!0});var d=P(s);p=E(d,"DIV",{class:!0});var C=P(p);k=E(C,"LABEL",{for:!0,class:!0});var G=P(k);z=F(G,A),G.forEach(h),D=H(C),_=E(C,"INPUT",{id:!0,class:!0,placeholder:!0,"aria-label":!0}),C.forEach(h),N=H(d),J=E(d,"DIV",{class:!0});var I=P(J);M=E(I,"LABEL",{for:!0,class:!0});var U=P(M);u=F(U,B),U.forEach(h),V=H(I),x=E(I,"INPUT",{id:!0,class:!0,placeholder:!0,"aria-label":!0}),I.forEach(h),S=H(d),W=E(d,"BUTTON",{type:!0,class:!0});var O=P(W);re=F(O,ae),O.forEach(h),d.forEach(h),v.forEach(h),se=H(c),ee=E(c,"DIV",{class:!0});var j=P(ee);le=E(j,"DIV",{class:!0});var te=P(le);q&&q.l(te),te.forEach(h),me=H(j),K&&K.l(j),j.forEach(h),c.forEach(h),this.h()},h(){m(r,"class","text-sm font-bold mb-2 uppercase tracking-wider"),m(k,"for","pair-a"),m(k,"class","text-xs text-wood-700/80 ml-1"),m(_,"id","pair-a"),m(_,"class","input-field svelte-1xz4pzu"),m(_,"placeholder","Nombre..."),_.disabled=g=a[7]||a[6],m(_,"aria-label",b=a[8]("playerA")),m(p,"class","flex flex-col gap-1"),m(M,"for","pair-b"),m(M,"class","text-xs text-wood-700/80 ml-1"),m(x,"id","pair-b"),m(x,"class","input-field svelte-1xz4pzu"),m(x,"placeholder","Nombre..."),x.disabled=L=a[7]||a[6],m(x,"aria-label",w=a[8]("playerB")),m(J,"class","flex flex-col gap-1"),m(W,"type","button"),m(W,"class","inline-flex items-center justify-center h-9 px-4 rounded-full bg-green-600 hover:bg-green-700 text-white disabled:opacity-50 disabled:cursor-not-allowed"),W.disabled=ne=!(a[1].trim()&&a[2].trim())||a[7]||a[6],m(s,"class","flex flex-wrap gap-2 items-end"),m(t,"class","p-3 rounded-lg border border-wood-300 bg-panel-50 shadow-card-md"),m(le,"class","flex-1"),m(ee,"class","flex flex-col lg:flex-row"),m(e,"class","space-y-4 bg-panel-100 text-panel-700 p-6 rounded-xl border border-wood-200 shadow-card-md")},m(T,c){Y(T,e,c),i(e,t),i(t,r),i(r,o),i(t,l),i(t,s),i(s,p),i(p,k),i(k,z),i(p,D),i(p,_),ue(_,a[1]),i(s,N),i(s,J),i(J,M),i(M,u),i(J,V),i(J,x),ue(x,a[2]),i(s,S),i(s,W),i(W,re),i(e,se),i(e,ee),i(ee,le),q&&q.m(le,null),i(ee,me),K&&K.m(ee,null),X=!0,he||(_e=[ie(_,"input",a[13]),ie(x,"input",a[14]),ie(W,"click",a[9])],he=!0)},p(T,c){(!X||c[0]&256)&&n!==(n=T[8]("addPair")+"")&&Q(o,n),(!X||c[0]&256)&&A!==(A=T[8]("playerA")+"")&&Q(z,A),(!X||c[0]&192&&g!==(g=T[7]||T[6]))&&(_.disabled=g),(!X||c[0]&256&&b!==(b=T[8]("playerA")))&&m(_,"aria-label",b),c[0]&2&&_.value!==T[1]&&ue(_,T[1]),(!X||c[0]&256)&&B!==(B=T[8]("playerB")+"")&&Q(u,B),(!X||c[0]&192&&L!==(L=T[7]||T[6]))&&(x.disabled=L),(!X||c[0]&256&&w!==(w=T[8]("playerB")))&&m(x,"aria-label",w),c[0]&4&&x.value!==T[2]&&ue(x,T[2]),(!X||c[0]&256)&&ae!==(ae=T[8]("addPair")+"")&&Q(re,ae),(!X||c[0]&198&&ne!==(ne=!(T[1].trim()&&T[2].trim())||T[7]||T[6]))&&(W.disabled=ne),T[4]?q?(q.p(T,c),c[0]&16&&de(q,1)):(q=Ze(T),q.c(),de(q,1),q.m(le,null)):q&&(Te(),ge(q,1,1,()=>{q=null}),Ve()),T[0]&&T[6]?K?c[0]&65&&de(K,1):(K=Fe(),K.c(),de(K,1),K.m(ee,null)):K&&(Te(),ge(K,1,1,()=>{K=null}),Ve())},i(T){X||(de(q),de(K),X=!0)},o(T){ge(q),ge(K),X=!1},d(T){T&&h(e),q&&q.d(),K&&K.d(),he=!1,Se(_e)}}}function nr(a){return a.split(/\r?\n/).map(e=>e.trim()).filter(Boolean).map((e,t)=>({id:String(t+1),name:e}))}function lr(a,e,t){let r,n;Ke(a,Ae,c=>t(8,n=c));let o="",l=[],s=[],p=new Set,k=!0,{allowViewer:A=!0}=e;const z={masc:["Adur","Aimar","Aitor","Ametz","Ander","Antton","Aratz","Asier","Beñat","Bittor","Egoi","Ekaitz","Ekhi","Enaitz","Eneko","Endika","Eñaut","Gaizka","Gorka","Hodei","Ibai","Iban","Igor","Iker","Imanol","Iñaki","Iñigo","Ipar","Iraitz","Iurgi","Izani","Jabi","Jakes","Joanes","Jokin","Jon","Josu","Julen","Kepa","Lander","Luken","Markel","Mattin","Mikel","Oihan","Oier","Orhi","Ortzi","Patxi","Peio","Unai","Unax","Urko","Xabier","Zigor"],fem:["Aia","Ainhoa","Ainara","Aintzane","Aizpea","Alaia","Alaitz","Alazne","Amagoia","Amaia","Ane","Araitz","Arantxa","Arene","Argi","Eba","Edurne","Eider","Ekiñe","Elaia","Elori","Enara","Estibaliz","Garazi","Garbiñe","Goizane","Haizea","Idoia","Irati","Iraia","Iratxe","Irune","Itsaso","Itziar","Izaro","Izaskun","Jone","Larraitz","Leire","Lide","Lorea","Maddi","Maialen","Maitane","Maite","Malen","Miren","Nagore","Naia","Naiara","Naroa","Nekane","Nerea","Oihana","Olatz","Onintza","Udane","Uxue","Zuriñe"]},D=["Abaitua","Agirre","Aizpurua","Alberdi","Alkorta","Altuna","Amundarain","Anitua","Ansotegi","Arana","Aranguren","Aranzabal","Areitio","Aretxabaleta","Aristi","Aristizabal","Armendariz","Arregi","Arrieta","Arrizabalaga","Arruabarrena","Artetxe","Azkarate","Azkue","Azurmendi","Barandiaran","Barrenetxea","Basagoiti","Bengoa","Bengoetxea","Berasategi","Bilbao","Bolibar","Echevarría","Elorriaga","Elorza","Elustondo","Erreka","Eskibel","Etxeberria","Gabiria","Gabilondo","Galarza","Galdos","Garate","Garmendia","Gaztelu","Goikoetxea","Gurrutxaga","Ibarra","Ibarretxe","Idigoras","Igartua","Iraola","Iriondo","Irusta","Iturbe","Iturriaga","Izagirre","Laka","Landa","Larrañaga","Larrinaga","Lazkano","Legarreta","Lertxundi","Loyola","Madariaga","Maguregi","Maiz","Mendieta","Mendizabal","Muguruza","Munitiz","Murua","Ochoa","Olabarria","Olarte","Olaizola","Ondarra","Orbegozo","Ordorika","Ormaetxea","Orozko","Osa","Otegi","Otxoa","Pagadi","Pagaldai","Retegi","Sagasti","Salaberria","Sarasola","Soraluze","Tellechea","Unamuno","Urbina","Uriarte","Uribarri","Uribe","Urkizu","Urkullu","Urrutia","Urrutikoetxea","Zabala","Zabaleta","Zaldibar","Zearra","Zelaia","Zubiria","Zubizarreta","Zuloaga"],_=[...z.masc,...z.fem];(()=>{const c=[];for(const f of D){for(const d of _)if(c.push(`${d} ${f}`),c.length===256)break;if(c.length===256)break}let v=1;for(;c.length<256;)c.push(`Jugador ${v}`),v++;return er(c)})();function g(c){const v=_,f=D;if(!v.length||!f.length)return null;const d=v.length*f.length;for(let C=0;C<d;C++){const G=v[Math.floor(Math.random()*v.length)],I=f[Math.floor(Math.random()*f.length)],U=`${G} ${I}`;if(!c.has(U))return U}return null}function b(c){const v=[],f=new Set;for(let d=0;d<c;d++){const C=g(f)||`Jugador ${d+1}`;f.add(C),v.push(C)}return v}let N=[],J=!1,M=!1,B=null,u=null,V=null,x=!1,L=null,w="",S="";function W(){l=nr(o).map((v,f)=>({...v,id:String(f+1)})),t(3,s=[]),p.clear(),ve(l)}function ae(){console.log("addPairByNames called",{pairAName:w,pairBName:S,canAddPairByNames:r});const c=w.trim(),v=S.trim();if(!c||!v)return;const f=G=>{let I=l.find(U=>U.name===G);if(!I){const U=l.reduce((O,j)=>Math.max(O,Number(j.id)),0);I={id:String(U+1),name:G},l=[...l,I],ve(l)}return I},d=f(c),C=f(v);t(3,s=[...s,[d,C]]),t(4,k=!0),t(1,w=""),t(2,S=""),Ce(s.map(G=>({a:G[0].name,b:G[1].name})))}function re(c){t(3,s=s.filter((v,f)=>f!==c)),Ce(s.map(v=>({a:v[0].name,b:v[1].name})))}function ne(c){const{index:v,a:f,b:d}=c,C=f.trim(),G=d.trim();if(!C||!G)return;const I=j=>{let te=l.find(R=>R.name===j);if(!te){const R=l.reduce((ce,Oe)=>Math.max(ce,Number(Oe.id)),0);te={id:String(R+1),name:j},l=[...l,te],ve(l)}return te},U=I(C),O=I(G);t(3,s=s.map((j,te)=>te===v?[U,O]:j)),Ce(s.map(j=>({a:j[0].name,b:j[1].name})))}async function se(c="single_elimination"){if(!A){console.warn("Viewer disabled here - renderWithManager aborted");return}if(s.length===0&&!(x&&L)){console.warn("No pairs to render with Manager");return}J=!0,t(6,M=!0),await pt();try{const{BracketsManager:v}=await ze(()=>import("./index.42f7075a.js").then(R=>R.i),[]),{default:f}=await ze(()=>import("./inMemoryStorage.942a0156.js"),[]);let d=new f,C=new v(d);if(x&&L)d.data.stage=JSON.parse(JSON.stringify(L.stages||[])),d.data.match=JSON.parse(JSON.stringify(L.matches||[])),d.data.participant=JSON.parse(JSON.stringify(L.participants||[])),d.data.match_game=JSON.parse(JSON.stringify(L.matchGames||[])),V=d,u=C,console.log("Using saved random stage for rendering");else{const ce=s.map((ke,be)=>`${ke[0].name} / ${ke[1].name} #${be+1}`),Pe=(ke=>{let be=1;for(;be<ke;)be<<=1;return be})(ce.length);await C.create({tournamentId:0,name:"Stage",type:c,seeding:ce,settings:{size:Pe}}),Pe!==ce.length&&console.log("Adjusted stage size to next power of two",{requested:ce.length,adjusted:Pe});const lt=d.data.stage||[],ot=d.data.match||[],st=d.data.participant||[],or=d.data.match_game||[];V=d,u=C,console.log("Manager produced:",{stagesLength:lt.length,matchesLength:ot.length,participantsLength:st.length})}const G=d.data.stage||[],I=d.data.match||[],U=d.data.participant||[],O=d.data.match_game||[];B={stages:G,matches:I,matchGames:O,participants:U},window.__renderSavedStage=async()=>{try{await se(),console.log("Manual re-render of saved stage performed")}catch(R){console.error("Manual re-render failed",R)}};const j=xe(I,U);try{t(5,N=(j.matches||[]).filter(R=>R.roundIndex===0).map(R=>({a:R.sides[0]?.title||"",b:R.sides[1]?.title||""})))}catch{t(5,N=[])}const te=document.getElementById("brackets-viewer-wrapper");if(te)try{te.innerHTML="",te.style.height="100%",await me(j,te)?(X(),le()):console.warn("Bracket rendering failed and fallback content was shown")}catch(R){console.error("Could not render bracketry",R,R?.stack);try{window.__lastRenderError={message:R?.message||String(R),stack:R?.stack||null}}catch{}try{te.innerHTML='<div class="render-error p-2 rounded bg-red-50 border border-red-200"><strong>Error rendering bracket:</strong><div style="white-space:pre-wrap;margin-top:8px;">'+(R?.message||String(R))+'</div><hr style="margin:8px 0;"/><pre>'+JSON.stringify(j,null,2)+'</pre><div style="margin-top:8px;font-size:0.8rem;color:#666">Tip: puedes volver a intentar con <code>window.__renderSavedStage()</code></div></div>'}catch{te.innerHTML="<pre>"+JSON.stringify(j,null,2)+"</pre>"}}console.log("Brackets rendered from manager successfully"),J=!0,t(6,M=!0)}catch(v){console.error("renderWithManager failed",v)}finally{}}async function ee(c){const v=c??B;if(!v){console.warn("No manager data to render");return}const{stages:f,matches:d,matchGames:C,participants:G}=v;let I=document.getElementById("brackets-viewer-wrapper");I||(console.warn("No #brackets-viewer-wrapper in DOM — creating fallback container"),I=document.createElement("div"),I.id="brackets-viewer-wrapper",I.classList.add("brackets-viewer","mt-2","w-full","min-h-[240px]","overflow-x-auto"),(document.querySelector("main")||document.body).appendChild(I)),I.innerHTML="",I.classList.add("brackets-viewer"),I.classList.add("compact");try{const U=xe(d,G);try{t(5,N=(U.matches||[]).filter(j=>j.roundIndex===0).map(j=>({a:j.sides[0]?.title||"",b:j.sides[1]?.title||""})))}catch{t(5,N=[])}const O=document.getElementById("brackets-viewer-wrapper");O&&(O.innerHTML="",O.style.height="100%",await me(U,O)?(X(),le(),le()):console.warn("Bracket rendering failed and fallback content was shown"))}catch(U){console.error("renderManagerViewer failed",U)}}function le(){const c=document.getElementById("brackets-viewer-wrapper")||document.querySelector(".bracket-viewport");c&&(c.querySelectorAll("*").forEach(v=>{const f=v;if(f.children.length===0&&typeof f.textContent=="string"){const C=f.textContent.trim().match(/^Round\s*(\d+)/i);C&&(f.textContent=Je(Ae)("round_label",{n:C[1]}))}}),c.querySelectorAll(".round-label, .round-title").forEach(v=>{const f=v;f.textContent=(f.textContent||"").replace(/Round\s*(\d+)/i,(d,C)=>Je(Ae)("round_label",{n:C}))}))}async function me(c,v){try{const{createBracket:f}=await ze(()=>import("./index.59f06f24.js"),[]);return window.__advanceMatch=(d,C)=>he(d,C),f(c,v,{onMatchSideClick:(d,C)=>{window.__advanceMatch?.(d.matchId,C+1)}}),!0}catch(f){console.error("safeCreateBracket failed",f,f?.stack);try{window.__lastBracketError=f,window.__lastBracketStack=f?.stack||null}catch{}try{v.innerHTML='<div class="render-error p-2 rounded bg-red-50 border border-red-200"><strong>Error rendering bracket:</strong><div style="white-space:pre-wrap;margin-top:8px;">'+(f?.message||String(f))+'</div><hr style="margin:8px 0;"/><pre>'+JSON.stringify(c,null,2)+'</pre><div style="margin-top:8px;font-size:0.8rem;color:#666">Tip: puedes volver a intentar con <code>window.__renderSavedStage()</code></div></div>'}catch{v.innerHTML="<pre>"+JSON.stringify(c,null,2)+"</pre>"}return!1}}function X(){if(!B||!u)return;const c=document.getElementById("brackets-viewer-wrapper");c&&(c.querySelectorAll(".participant").forEach(v=>{v.replaceWith(v.cloneNode(!0))}),c.querySelectorAll("[data-match-id]").forEach(v=>{const f=Number(v.getAttribute("data-match-id"));v.querySelectorAll(".participant").forEach((C,G)=>{C.addEventListener("click",async I=>{I.stopPropagation(),await he(f,G+1)})})}))}async function he(c,v){if(!u||!V){console.warn("Manager or DB not available for update");return}try{console.log("User selected winner:",{matchId:c,participantSide:v});const f={id:c};v===1?(f.opponent1={score:1,result:"win"},f.opponent2={score:0}):(f.opponent1={score:0},f.opponent2={score:1,result:"win"}),await u.update.match(f);const d=V.data.stage||[],C=V.data.match||[],G=V.data.participant||[],I=V.data.match_game||[];B={stages:d,matches:C,matchGames:I,participants:G},await ee(B);try{const U=xe(C,G),O=document.getElementById("brackets-viewer-wrapper");O&&(O.innerHTML="",O.style.height="100%",await me(U,O)?X():console.warn("Bracket re-render failed and fallback content was shown"))}catch(U){console.error("Could not re-render bracketry after match update",U)}console.log("Match updated and viewer re-rendered for match",c)}catch(f){console.error("Could not update match",f)}}mt(async()=>{console.log("Players component hydrated on client (onMount)");const c=tr();if(c&&c.length){l=c;const f=new Set(l.map(d=>d.name));l=l.map(d=>{if(/^Jugador\s*\d+$/i.test(d.name)){const C=g(f);if(C)return f.add(C),{...d,name:C}}return d}),o=l.map(d=>d.name).join(`
`),ve(l)}else o=b(8).join(`
`),W();const v=ar();if(v&&v.length){const f=new Set(l.map(d=>d.name));for(const d of v){let C=d.a;if(/^Jugador\s*\d+$/i.test(d.a)){const I=g(f);I&&(C=I,f.add(I))}if(!l.find(I=>I.name===C)){const I=l.reduce((U,O)=>Math.max(U,Number(O.id)),0);l=[...l,{id:String(I+1),name:C}]}let G=d.b;if(/^Jugador\s*\d+$/i.test(d.b)){const I=g(f);I&&(G=I,f.add(I))}if(!l.find(I=>I.name===G)){const I=l.reduce((U,O)=>Math.max(U,Number(O.id)),0);l=[...l,{id:String(I+1),name:G}]}}ve(l),t(3,s=v.map(d=>{const C=/^Jugador\s*\d+$/i.test(d.a)?l.find(O=>O.name!==void 0&&O.name===d.a)?d.a:l.find(O=>O.name!==void 0&&O.name.startsWith(d.a.split(" ")[0])).name:d.a,G=l.find(O=>O.name===C),I=/^Jugador\s*\d+$/i.test(d.b)?l.find(O=>O.name!==void 0&&O.name===d.b)?d.b:l.find(O=>O.name!==void 0&&O.name.startsWith(d.b.split(" ")[0])).name:d.b,U=l.find(O=>O.name===I);return[G,U]}))}try{const f=localStorage.getItem("randomStageData");f&&(L=JSON.parse(f),t(7,x=!!L))}catch(f){console.warn("Could not load saved random stage",f)}if(A&&x&&L)try{await se()}catch(f){console.error("Could not auto-render saved random stage on mount",f)}}),ht(()=>{});function _e(){w=this.value,t(1,w)}function q(){S=this.value,t(2,S)}const K=c=>re(c.detail),T=c=>ne(c.detail);return a.$$set=c=>{"allowViewer"in c&&t(0,A=c.allowViewer)},a.$$.update=()=>{a.$$.dirty[0]&6&&t(12,r=w.trim().length>0&&S.trim().length>0),a.$$.dirty[0]&4102&&console.log("pair inputs:",JSON.stringify(w),JSON.stringify(S),"trim lengths",w.trim().length,S.trim().length,"canAddPairByNames",r)},[A,w,S,s,k,N,M,x,n,ae,re,ne,r,_e,q,K,T]}class cr extends Ne{constructor(e){super(),Me(this,e,lr,rr,Be,{allowViewer:0},null,[-1,-1])}}export{cr as default};
